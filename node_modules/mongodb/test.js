var MongoClient=require("./").MongoClient,ReadPreference=require("./").ReadPreference,uri="mongodb://admin:admin@localhost:27017,localhost:27018/admin",uri="mongodb://localhost:31000,localhost:31001/test?replicaSet=rs",uri="mongodb://muser:mpass@ds015510-a0.mlab.com:15510,ds015510-a1.mlab.com:15510/test?replicaSet=rs-ds015510",interval=500,i=0,openThenClose=function(){i+=1,100==i&&(clearInterval(intervalId),setInterval(function(){console.log("wait for drain")},interval)),console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! MongoClient.connect"),MongoClient.connect(uri,{},function(e,o){console.log("open");var n=o.collection("collection").find().setReadPreference(ReadPreference.SECONDARY).batchSize(2);n.toArray(function(e,n){console.log("-------------------------------------------------"),o.serverConfig.connections().forEach(function(e){console.log("--- "+e.host)}),o.close(function(){console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! close")})})})},intervalId=setInterval(function(){openThenClose()},interval);