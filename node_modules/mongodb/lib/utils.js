"use strict";var MongoError=require("mongodb-core").MongoError,f=require("util").format,shallowClone=function(e){var r={};for(var t in e)r[t]=e[t];return r},getSingleProperty=function(e,r,t){Object.defineProperty(e,r,{enumerable:!0,get:function(){return t}})},formatSortValue=exports.formatSortValue=function(e){var r=(""+e).toLowerCase();switch(r){case"ascending":case"asc":case"1":return 1;case"descending":case"desc":case"-1":return-1;default:throw new Error("Illegal sort clause, must be of the form [['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]")}},formattedOrderClause=exports.formattedOrderClause=function(e){var r={};if(null==e)return null;if(Array.isArray(e)){if(0===e.length)return null;for(var t=0;t<e.length;t++)e[t].constructor==String?r[e[t]]=1:r[e[t][0]]=formatSortValue(e[t][1])}else if(null!=e&&"object"==typeof e)r=e;else{if("string"!=typeof e)throw new Error("Illegal sort clause, must be of the form [['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]");r[e]=1}return r},checkCollectionName=function(e){if("string"!=typeof e)throw Error("collection name must be a String");if(!e||-1!=e.indexOf(".."))throw Error("collection names cannot be empty");if(-1!=e.indexOf("$")&&null==e.match(/((^\$cmd)|(oplog\.\$main))/))throw Error("collection names must not contain '$'");if(null!=e.match(/^\.|\.$/))throw Error("collection names must not start or end with '.'");if(~e.indexOf("\x00"))throw new Error("collection names cannot contain a null character")},handleCallback=function(e,r,t,n){try{if(null==e)return;return n?e(r,t,n):e(r,t)}catch(r){return process.nextTick(function(){throw r}),!1}return!0},toError=function(e){if(e instanceof Error)return e;for(var r=e.err||e.errmsg||e.errMessage||e,t=MongoError.create({message:r,driver:!0}),n="object"==typeof e?Object.keys(e):[],o=0;o<n.length;o++)try{t[n[o]]=e[n[o]]}catch(a){}return t},normalizeHintField=function(e){var r=null;if("string"==typeof e)r=e;else if(Array.isArray(e))r={},e.forEach(function(e){r[e]=1});else if(null!=e&&"object"==typeof e){r={};for(var t in e)r[t]=e[t]}return r},parseIndexOptions=function(e){var r,t={},n=[];return"string"==typeof e?(n.push(e+"_1"),t[e]=1):Array.isArray(e)?e.forEach(function(e){"string"==typeof e?(n.push(e+"_1"),t[e]=1):Array.isArray(e)?(n.push(e[0]+"_"+(e[1]||1)),t[e[0]]=e[1]||1):isObject(e)&&(r=Object.keys(e),r.forEach(function(r){n.push(r+"_"+e[r]),t[r]=e[r]}))}):isObject(e)&&(r=Object.keys(e),r.forEach(function(r){n.push(r+"_"+e[r]),t[r]=e[r]})),{name:n.join("_"),keys:r,fieldHash:t}},isObject=exports.isObject=function(e){return"[object Object]"==toString.call(e)},debugOptions=function(e,r){var t={};return e.forEach(function(e){t[e]=r[e]}),t},decorateCommand=function(e,r,t){for(var n in r)null==t[n]&&(e[n]=r[n]);return e},mergeOptions=function(e,r){for(var t in r)e[t]=r[t];return e},translateOptions=function(e,r){var t={sslCA:"ca",sslValidate:"rejectUnauthorized",sslKey:"key",sslCert:"cert",sslPass:"passphrase",socketTimeoutMS:"socketTimeout",connectTimeoutMS:"connectionTimeout",replicaSet:"setName",rs_name:"setName",secondaryAcceptableLatencyMS:"acceptableLatency",connectWithNoPrimary:"secondaryOnlyConnectionAllowed",acceptableLatencyMS:"localThresholdMS"};for(var n in r)t[n]?e[t[n]]=r[n]:e[n]=r[n];return e},filterOptions=function(e,r){var t={};for(var n in e)-1!=r.indexOf(n)&&(t[n]=e[n]);return t},assign=Object.assign?Object.assign:function(e,r){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(void 0!==o&&null!==o)for(var a=Object.keys(Object(o)),s=0,i=a.length;i>s;s++){var c=a[s],l=Object.getOwnPropertyDescriptor(o,c);void 0!==l&&l.enumerable&&(t[c]=o[c])}}return t};exports.filterOptions=filterOptions,exports.mergeOptions=mergeOptions,exports.translateOptions=translateOptions,exports.shallowClone=shallowClone,exports.getSingleProperty=getSingleProperty,exports.checkCollectionName=checkCollectionName,exports.toError=toError,exports.formattedOrderClause=formattedOrderClause,exports.parseIndexOptions=parseIndexOptions,exports.normalizeHintField=normalizeHintField,exports.handleCallback=handleCallback,exports.decorateCommand=decorateCommand,exports.isObject=isObject,exports.debugOptions=debugOptions,exports.MAX_JS_INT=9007199254740992,exports.assign=assign;