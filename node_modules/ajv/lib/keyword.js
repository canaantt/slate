"use strict";var IDENTIFIER=/^[a-z_$][a-z0-9_$]*$/i,customRuleCode=require("./dotjs/custom");module.exports=function(e,r){function t(e,r,t){for(var o,a=0;a<i.RULES.length;a++){var s=i.RULES[a];if(s.type==r){o=s;break}}o||(o={type:r,rules:[]},i.RULES.push(o));var n={keyword:e,definition:t,custom:!0,code:customRuleCode};o.rules.push(n),i.RULES.custom[e]=n}function o(e){if(!i.RULES.types[e])throw new Error("Unknown type "+e)}var i=this;if(this.RULES.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!IDENTIFIER.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(r){var a=r.type;if(Array.isArray(a)){var s,n=a.length;for(s=0;n>s;s++)o(a[s]);for(s=0;n>s;s++)t(e,a[s],r)}else a&&o(a),t(e,a,r);var d=r.$data===!0&&this._opts.v5;if(d&&!r.validate)throw new Error('$data support: neither "validate" nor "compile" functions are defined');var f=r.metaSchema;f&&(d&&(f={anyOf:[f,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}),r.validateSchema=i.compile(f,!0))}this.RULES.keywords[e]=this.RULES.all[e]=!0};