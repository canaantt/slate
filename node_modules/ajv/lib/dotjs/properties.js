"use strict";module.exports=function(e,r){var a,t=" ",s=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+"."+r,h=e.errSchemaPath+"/"+r,v=!e.opts.allErrors,p="data"+(o||""),n="valid"+s,c="errs__"+s,u=e.util.copy(e),d="";u.level++;var P="key"+s,m=u.dataLevel=e.dataLevel+1,f="data"+m,g=Object.keys(i||{}),y=e.schema.patternProperties||{},E=Object.keys(y),k=e.schema.additionalProperties,S=g.length||E.length,b=k===!1,R="object"==typeof k&&Object.keys(k).length,O=e.opts.removeAdditional,w=b||R||O,j=e.opts.ownProperties,x=e.baseId,A=e.schema.required;if(A&&(!e.opts.v5||!A.$data)&&A.length<e.opts.loopRequired)var G=e.util.toHash(A);if(e.opts.v5)var Q=e.schema.patternGroups||{},_=Object.keys(Q);if(t+="var "+c+" = errors;var valid"+u.level+" = true;",w){if(t+=" for (var "+P+" in "+p+") {  ",j&&(t+=" if (!Object.prototype.hasOwnProperty.call("+p+", "+P+")) continue; "),S){if(t+=" var isAdditional"+s+" = !(false ",g.length)if(g.length>5)t+=" || validate.schema"+l+"["+P+"] ";else{var q=g;if(q)for(var D,I=-1,L=q.length-1;L>I;)D=q[I+=1],t+=" || "+P+" == "+e.util.toQuotedString(D)+" "}if(E.length){var C=E;if(C)for(var H,U=-1,V=C.length-1;V>U;)H=C[U+=1],t+=" || "+e.usePattern(H)+".test("+P+") "}if(e.opts.v5&&_&&_.length){var F=_;if(F)for(var N,U=-1,T=F.length-1;T>U;)N=F[U+=1],t+=" || "+e.usePattern(N)+".test("+P+") "}t+=" ); if (isAdditional"+s+") { "}if("all"==O)t+=" delete "+p+"["+P+"]; ";else{var $=e.errorPath,z="' + key"+s+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,"key"+s,e.opts.jsonPointers)),b)if(O)t+=" delete "+p+"["+P+"]; ";else{t+=" valid"+u.level+" = false; ";var B=h;h=e.errSchemaPath+"/additionalProperties";var J=J||[];J.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(a||"additionalProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+' , schemaPath: "'+h+"\" , params: { additionalProperty: '"+z+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have additional properties' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var K=t;t=J.pop(),t+=!e.compositeRule&&v?e.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h=B,v&&(t+=" break; ")}else if(R)if("failing"==O){t+=" var "+c+" = errors;  ";var M=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.schema=k,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,"key"+s,e.opts.jsonPointers);var W=p+"[key"+s+"]";u.dataPathArr[m]="key"+s;var X=e.validate(u);u.baseId=x,t+=e.util.varOccurences(X,f)<2?" "+e.util.varReplace(X,f,W)+" ":" var "+f+" = "+W+"; "+X+" ",t+=" if (!valid"+u.level+") { errors = "+c+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+P+"]; }  ",e.compositeRule=u.compositeRule=M}else{u.schema=k,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,"key"+s,e.opts.jsonPointers);var W=p+"[key"+s+"]";u.dataPathArr[m]="key"+s;var X=e.validate(u);u.baseId=x,t+=e.util.varOccurences(X,f)<2?" "+e.util.varReplace(X,f,W)+" ":" var "+f+" = "+W+"; "+X+" ",v&&(t+=" if (!valid"+u.level+") break; ")}e.errorPath=$}S&&(t+=" } "),t+=" }  ",v&&(t+=" if (valid"+u.level+") { ",d+="}")}var Y=e.opts.useDefaults&&!e.compositeRule;if(g.length){var Z=g;if(Z)for(var D,ee=-1,re=Z.length-1;re>ee;){D=Z[ee+=1];var ae=i[D];if(e.util.schemaHasRules(ae,e.RULES.all)){var te=e.util.getProperty(D),W=p+te,se=Y&&void 0!==ae["default"];u.schema=ae,u.schemaPath=l+te,u.errSchemaPath=h+"/"+e.util.escapeFragment(D),u.errorPath=e.util.getPath(e.errorPath,D,e.opts.jsonPointers),u.dataPathArr[m]=e.util.toQuotedString(D);var X=e.validate(u);if(u.baseId=x,e.util.varOccurences(X,f)<2){X=e.util.varReplace(X,f,W);var oe=W}else{var oe=f;t+=" var "+f+" = "+W+"; "}if(se)t+=" "+X+" ";else{if(G&&G[D]){t+=" if ("+oe+" === undefined) { valid"+u.level+" = false; ";var $=e.errorPath,B=h,ie=e.util.escapeQuotes(D);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath($,D,e.opts.jsonPointers)),h=e.errSchemaPath+"/required";var J=J||[];J.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(a||"required")+"' , dataPath: (dataPath || '') + "+e.errorPath+' , schemaPath: "'+h+"\" , params: { missingProperty: '"+ie+"' } ",e.opts.messages!==!1&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+ie+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var K=t;t=J.pop(),t+=!e.compositeRule&&v?e.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h=B,e.errorPath=$,t+=" } else { "}else t+=v?" if ("+oe+" === undefined) { valid"+u.level+" = true; } else { ":" if ("+oe+" !== undefined) { ";t+=" "+X+" } "}}v&&(t+=" if (valid"+u.level+") { ",d+="}")}}var le=E;if(le)for(var H,he=-1,ve=le.length-1;ve>he;){H=le[he+=1];var ae=y[H];if(e.util.schemaHasRules(ae,e.RULES.all)){u.schema=ae,u.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(H),u.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(H),t+=" for (var "+P+" in "+p+") {  ",j&&(t+=" if (!Object.prototype.hasOwnProperty.call("+p+", "+P+")) continue; "),t+=" if ("+e.usePattern(H)+".test("+P+")) { ",u.errorPath=e.util.getPathExpr(e.errorPath,"key"+s,e.opts.jsonPointers);var W=p+"[key"+s+"]";u.dataPathArr[m]="key"+s;var X=e.validate(u);u.baseId=x,t+=e.util.varOccurences(X,f)<2?" "+e.util.varReplace(X,f,W)+" ":" var "+f+" = "+W+"; "+X+" ",v&&(t+=" if (!valid"+u.level+") break; "),t+=" } ",v&&(t+=" else valid"+u.level+" = true; "),t+=" }  ",v&&(t+=" if (valid"+u.level+") { ",d+="}")}}if(e.opts.v5){var pe=_;if(pe)for(var N,ne=-1,ce=pe.length-1;ce>ne;){N=pe[ne+=1];var ue=Q[N],ae=ue.schema;if(e.util.schemaHasRules(ae,e.RULES.all)){u.schema=ae,u.schemaPath=e.schemaPath+".patternGroups"+e.util.getProperty(N)+".schema",u.errSchemaPath=e.errSchemaPath+"/patternGroups/"+e.util.escapeFragment(N)+"/schema",t+=" var pgPropCount"+s+" = 0; for (var "+P+" in "+p+") {  ",j&&(t+=" if (!Object.prototype.hasOwnProperty.call("+p+", "+P+")) continue; "),t+=" if ("+e.usePattern(N)+".test("+P+")) { pgPropCount"+s+"++; ",u.errorPath=e.util.getPathExpr(e.errorPath,"key"+s,e.opts.jsonPointers);var W=p+"[key"+s+"]";u.dataPathArr[m]="key"+s;var X=e.validate(u);u.baseId=x,t+=e.util.varOccurences(X,f)<2?" "+e.util.varReplace(X,f,W)+" ":" var "+f+" = "+W+"; "+X+" ",v&&(t+=" if (!valid"+u.level+") break; "),t+=" } ",v&&(t+=" else valid"+u.level+" = true; "),t+=" }  ",v&&(t+=" if (valid"+u.level+") { ",d+="}");var de=ue.minimum,Pe=ue.maximum;if(void 0!==de||void 0!==Pe){t+=" var "+n+" = true; ";var B=h;if(void 0!==de){var me=de,fe="minimum",ge="less";t+=" "+n+" = pgPropCount"+s+" >= "+de+"; ",h=e.errSchemaPath+"/patternGroups/minimum",t+="  if (!"+n+") {   ";var J=J||[];J.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(a||"patternGroups")+"' , dataPath: (dataPath || '') + "+e.errorPath+' , schemaPath: "'+h+"\" , params: { reason: '"+fe+"', limit: "+me+", pattern: '"+e.util.escapeQuotes(N)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have "+ge+" than "+me+' properties matching pattern "'+e.util.escapeQuotes(N)+"\"' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var K=t;t=J.pop(),t+=!e.compositeRule&&v?e.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",void 0!==Pe&&(t+=" else ")}if(void 0!==Pe){var me=Pe,fe="maximum",ge="more";t+=" "+n+" = pgPropCount"+s+" <= "+Pe+"; ",h=e.errSchemaPath+"/patternGroups/maximum",t+="  if (!"+n+") {   ";var J=J||[];J.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(a||"patternGroups")+"' , dataPath: (dataPath || '') + "+e.errorPath+' , schemaPath: "'+h+"\" , params: { reason: '"+fe+"', limit: "+me+", pattern: '"+e.util.escapeQuotes(N)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have "+ge+" than "+me+' properties matching pattern "'+e.util.escapeQuotes(N)+"\"' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var K=t;t=J.pop(),t+=!e.compositeRule&&v?e.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}h=B,v&&(t+=" if ("+n+") { ",d+="}")}}}}return v&&(t+=" "+d+" if ("+c+" == errors) {"),t=e.util.cleanUpCode(t)};