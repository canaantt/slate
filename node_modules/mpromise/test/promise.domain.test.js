var Promise=require("../"),Domain=require("domain").Domain,assert=require("assert");describe("domains",function(){it("exceptions should not breakout of domain boundaries",function(n){if(0!=process.version.indexOf("v0.10"))return n();var e=new Domain;e.on("error",function(e){assert.equal(e.message,"gaga"),n()});var r=new Promise;e.run(function(){r.then(function(){}).then(function(){throw new Error("gaga")}).end()}),process.nextTick(function(){r.fulfill()})})});