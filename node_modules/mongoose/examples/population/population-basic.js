function createData(){Console.create({name:"Nintendo 64",manufacturer:"Nintendo",released:"September 29, 1996"},function(e,o){return e?done(e):void Game.create({name:"Legend of Zelda: Ocarina of Time",developer:"Nintendo",released:new Date("November 21, 1998"),consoles:[o]},function(e){return e?done(e):void example()})})}function example(){Game.findOne({name:/^Legend of Zelda/}).populate("consoles").exec(function(e,o){return e?done(e):(console.log('"%s" was released for the %s on %s',o.name,o.consoles[0].name,o.released.toLocaleDateString()),void done())})}function done(e){e&&console.error(e),Console.remove(function(){Game.remove(function(){mongoose.disconnect()})})}var mongoose=require("../../lib"),Schema=mongoose.Schema;console.log("Running mongoose version %s",mongoose.version);var consoleSchema=Schema({name:String,manufacturer:String,released:Date}),Console=mongoose.model("Console",consoleSchema),gameSchema=Schema({name:String,developer:String,released:Date,consoles:[{type:Schema.Types.ObjectId,ref:"Console"}]}),Game=mongoose.model("Game",gameSchema);mongoose.connect("mongodb://localhost/console",function(e){if(e)throw e;createData()});