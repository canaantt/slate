/*!
 * Module dependencies.
 */
function ObjectId(t,e){SchemaType.call(this,t,e,"ObjectID")}/*!
 * ignore
 */
function handleSingle(t){return this.cast(t)}/*!
 * ignore
 */
function defaultId(){return new oid}function resetId(t){return this.$__._id=null,t}var SchemaType=require("../schematype"),CastError=SchemaType.CastError,oid=require("../types/objectid"),utils=require("../utils"),Document;ObjectId.schemaName="ObjectId",/*!
 * Inherits from SchemaType.
 */
ObjectId.prototype=Object.create(SchemaType.prototype),ObjectId.prototype.constructor=ObjectId,ObjectId.prototype.auto=function(t){return t&&(this["default"](defaultId),this.set(resetId)),this},ObjectId.prototype.checkRequired=function(t,e){return SchemaType._isRef(this,t,e,!0)?!!t:t instanceof oid},ObjectId.prototype.cast=function(t,e,n){if(SchemaType._isRef(this,t,e,n)){if(null===t||void 0===t)return t;if(Document||(Document=require("./../document")),t instanceof Document)return t.$__.wasPopulated=!0,t;if(t instanceof oid)return t;if(Buffer.isBuffer(t)||!utils.isObject(t))throw new CastError("ObjectId",t,this.path);var o=e.$__fullPath(this.path),i=e.ownerDocument?e.ownerDocument():e,r=i.populated(o,!0),c=t;return e.$__.populated&&e.$__.populated[o]&&e.$__.populated[o].options&&e.$__.populated[o].options.options&&e.$__.populated[o].options.options.lean||(c=new r.options.model(t),c.$__.wasPopulated=!0),c}if(null===t||void 0===t)return t;if(t instanceof oid)return t;if(t._id){if(t._id instanceof oid)return t._id;if(t._id.toString instanceof Function)try{return new oid(t._id.toString())}catch(a){}}if(t.toString instanceof Function)try{return new oid(t.toString())}catch(u){throw new CastError("ObjectId",t,this.path)}throw new CastError("ObjectId",t,this.path)},ObjectId.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle}),ObjectId.prototype.castForQuery=function(t,e){var n;if(2===arguments.length){if(n=this.$conditionalHandlers[t],!n)throw new Error("Can't use "+t+" with ObjectId.");return n.call(this,e)}return this.cast(t)},/*!
 * Module exports.
 */
module.exports=ObjectId;