"use strict";/*!
 * ignore
 */
function flatten(t,e,r){var a=Object.keys(t||{}),i=a.length,s={};e=e?e+".":"";for(var n=0;i>n;++n){var f=a[n],o=t[f];if(utils.isMongooseObject(o)&&!Buffer.isBuffer(o)&&(o=o.toObject({virtuals:!1})),shouldFlatten(o)){if(r&&r.skipArrays&&Array.isArray(o))continue;var u=flatten(o,e+f);for(var l in u)s[l]=u[l];Array.isArray(o)&&(s[e+f]=o)}else s[e+f]=o}return s}/*!
 * ignore
 */
function modifiedPaths(t,e,r){var a=Object.keys(t||{}),i=a.length;r=r||{},e=e?e+".":"";for(var s=0;i>s;++s){var n=a[s],f=t[n];r[e+n]=!0,shouldFlatten(f)&&modifiedPaths(f,e+n,r)}return r}/*!
 * ignore
 */
function shouldFlatten(t){return t&&"object"==typeof t&&!(t instanceof Date)&&!(t instanceof ObjectId)&&(!Array.isArray(t)||t.length>0)&&!(t instanceof Buffer)}/*!
 * Module dependencies.
 */
var ObjectId=require("../types/objectid"),utils=require("../utils");exports.flatten=flatten,exports.modifiedPaths=modifiedPaths;