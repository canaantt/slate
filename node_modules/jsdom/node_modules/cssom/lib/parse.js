var CSSOM={};CSSOM.parse=function(e){for(var r,t,a,S,l,s,n,u,i,o,c=0,m="before-selector",b="",f={selector:!0,value:!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,"documentRule-begin":!0},C=new CSSOM.CSSStyleSheet,R=C,p="",h=/@(-(?:\w+-)+)?keyframes/g,y=function(r){var t=e.substring(0,c).split("\n"),a=t.length,S=t.pop().length+1,l=new Error(r+" (line "+a+", char "+S+")");throw l.line=a,l["char"]=S,l.styleSheet=C,l};o=e.charAt(c);c++)switch(o){case" ":case"	":case"\r":case"\n":case"\f":f[m]&&(b+=o);break;case'"':r=c+1;do r=e.indexOf('"',r)+1,r||y('Unmatched "');while("\\"===e[r-2]);switch(b+=e.slice(c,r),c=r-1,m){case"before-value":m="value";break;case"importRule-begin":m="importRule"}break;case"'":r=c+1;do r=e.indexOf("'",r)+1,r||y("Unmatched '");while("\\"===e[r-2]);switch(b+=e.slice(c,r),c=r-1,m){case"before-value":m="value";break;case"importRule-begin":m="importRule"}break;case"/":"*"===e.charAt(c+1)?(c+=2,r=e.indexOf("*/",c),-1===r?y("Missing */"):c=r+1):b+=o,"importRule-begin"===m&&(b+=" ",m="importRule");break;case"@":if(e.indexOf("@-moz-document",c)===c){m="documentRule-begin",i=new CSSOM.CSSDocumentRule,i.__starts=c,c+="-moz-document".length,b="";break}if(e.indexOf("@media",c)===c){m="atBlock",l=new CSSOM.CSSMediaRule,l.__starts=c,c+="media".length,b="";break}if(e.indexOf("@import",c)===c){m="importRule-begin",c+="import".length,b+="@import";break}if(e.indexOf("@font-face",c)===c){m="fontFaceRule-begin",c+="font-face".length,n=new CSSOM.CSSFontFaceRule,n.__starts=c,b="";break}h.lastIndex=c;var k=h.exec(e);if(k&&k.index===c){m="keyframesRule-begin",u=new CSSOM.CSSKeyframesRule,u.__starts=c,u._vendorPrefix=k[1],c+=k[0].length-1,b="";break}"selector"===m&&(m="atRule"),b+=o;break;case"{":"selector"===m||"atRule"===m?(S.selectorText=b.trim(),S.style.__starts=c,b="",m="before-name"):"atBlock"===m?(l.media.mediaText=b.trim(),R=t=l,l.parentStyleSheet=C,b="",m="before-selector"):"fontFaceRule-begin"===m?(t&&(n.parentRule=t),n.parentStyleSheet=C,S=n,b="",m="before-name"):"keyframesRule-begin"===m?(u.name=b.trim(),t&&(u.parentRule=t),u.parentStyleSheet=C,R=t=u,b="",m="keyframeRule-begin"):"keyframeRule-begin"===m?(S=new CSSOM.CSSKeyframeRule,S.keyText=b.trim(),S.__starts=c,b="",m="before-name"):"documentRule-begin"===m&&(i.matcher.matcherText=b.trim(),t&&(i.parentRule=t),R=t=i,i.parentStyleSheet=C,b="",m="before-selector");break;case":":"name"===m?(a=b.trim(),b="",m="before-value"):b+=o;break;case"(":if("value"===m)if("expression"===b.trim()){var d=new CSSOM.CSSValueExpression(e,c).parse();d.error?y(d.error):(b+=d.expression,c=d.idx)}else m="value-parenthesis",b+=o;else b+=o;break;case")":"value-parenthesis"===m&&(m="value"),b+=o;break;case"!":"value"===m&&e.indexOf("!important",c)===c?(p="important",c+="important".length):b+=o;break;case";":switch(m){case"value":S.style.setProperty(a,b.trim(),p),p="",b="",m="before-name";break;case"atRule":b="",m="before-selector";break;case"importRule":s=new CSSOM.CSSImportRule,s.parentStyleSheet=s.styleSheet.parentStyleSheet=C,s.cssText=b+o,C.cssRules.push(s),b="",m="before-selector";break;default:b+=o}break;case"}":switch(m){case"value":S.style.setProperty(a,b.trim(),p),p="";case"before-name":case"name":S.__ends=c+1,t&&(S.parentRule=t),S.parentStyleSheet=C,R.cssRules.push(S),b="",m=R.constructor===CSSOM.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":t||y("Unexpected }"),R.__ends=c+1,C.cssRules.push(R),R=C,t=null,b="",m="before-selector"}break;default:switch(m){case"before-selector":m="selector",S=new CSSOM.CSSStyleRule,S.__starts=c;break;case"before-name":m="name";break;case"before-value":m="value";break;case"importRule-begin":m="importRule"}b+=o}return C},exports.parse=CSSOM.parse,CSSOM.CSSStyleSheet=require("./CSSStyleSheet").CSSStyleSheet,CSSOM.CSSStyleRule=require("./CSSStyleRule").CSSStyleRule,CSSOM.CSSImportRule=require("./CSSImportRule").CSSImportRule,CSSOM.CSSMediaRule=require("./CSSMediaRule").CSSMediaRule,CSSOM.CSSFontFaceRule=require("./CSSFontFaceRule").CSSFontFaceRule,CSSOM.CSSStyleDeclaration=require("./CSSStyleDeclaration").CSSStyleDeclaration,CSSOM.CSSKeyframeRule=require("./CSSKeyframeRule").CSSKeyframeRule,CSSOM.CSSKeyframesRule=require("./CSSKeyframesRule").CSSKeyframesRule,CSSOM.CSSValueExpression=require("./CSSValueExpression").CSSValueExpression,CSSOM.CSSDocumentRule=require("./CSSDocumentRule").CSSDocumentRule;