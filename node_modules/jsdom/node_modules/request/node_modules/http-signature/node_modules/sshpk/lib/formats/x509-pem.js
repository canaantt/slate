// Copyright 2016 Joyent, Inc.
function read(e,r){"string"!=typeof e&&(assert.buffer(e,"buf"),e=e.toString("ascii"));var i=e.trim().split(/[\r\n]+/g),t=i[0].match(/[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);assert.ok(t,"invalid PEM header");var a=i[i.length-1].match(/[-]+[ ]*END CERTIFICATE[ ]*[-]+/);assert.ok(a,"invalid PEM footer");for(var n={};;){if(i=i.slice(1),t=i[0].match(/^([A-Za-z0-9-]+): (.+)$/),!t)break;n[t[1].toLowerCase()]=t[2]}return i=i.slice(0,-1).join(""),e=new Buffer(i,"base64"),x509.read(e,r)}function write(e,r){var i=x509.write(e,r),t="CERTIFICATE",a=i.toString("base64"),n=a.length+a.length/64+18+16+2*t.length+10,s=new Buffer(n),u=0;u+=s.write("-----BEGIN "+t+"-----\n",u);for(var l=0;l<a.length;){var f=l+64;f>a.length&&(f=a.length),u+=s.write(a.slice(l,f),u),s[u++]=10,l=f}return u+=s.write("-----END "+t+"-----\n",u),s.slice(0,u)}var x509=require("./x509");module.exports={read:read,verify:x509.verify,sign:x509.sign,write:write};var assert=require("assert-plus"),asn1=require("asn1"),algs=require("../algs"),utils=require("../utils"),Key=require("../key"),PrivateKey=require("../private-key"),pem=require("./pem"),Identity=require("../identity"),Signature=require("../signature"),Certificate=require("../certificate");