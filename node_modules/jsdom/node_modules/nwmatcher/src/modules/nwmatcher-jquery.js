/*
 * Copyright (C) 2007-2016 Diego Perini
 * All rights reserved.
 *
 * this is just a small example to show
 * how an extension for NWMatcher could be
 * adapted to handle special jQuery selectors
 *
 * Child Selectors
 * :even, :odd, :eq, :lt, :gt, :first, :last, :nth
 *
 * Pseudo Selectors
 * :has, :button, :header, :input, :checkbox, :radio, :file, :image
 * :password, :reset, :submit, :text, :hidden, :visible, :parent
 *
 */
NW.Dom.registerSelector("jquery:child",/^\:((?:(nth|eq|lt|gt)\(([^()]*)\))|(?:even|odd|first|last))(.*)/i,function(e){return function(t,a,s){var r=!0,i=NW.Dom.ACCEPT_NODE;switch(t[1].toLowerCase()){case"odd":a=a.replace(i,"if((x=x^1)==0){"+i+"}");break;case"even":a=a.replace(i,"if((x=x^1)==1){"+i+"}");break;case"first":a="n=h.getElementsByTagName(e.nodeName);if(n.length&&n[0]===e){"+a+"}";break;case"last":a="n=h.getElementsByTagName(e.nodeName);if(n.length&&n[n.length-1]===e){"+a+"}";break;default:switch(t[2].toLowerCase()){case"nth":a="n=h.getElementsByTagName(e.nodeName);if(n.length&&n["+t[3]+"]===e){"+a+"}";break;case"eq":a=a.replace(i,"if(x++=="+t[3]+"){"+i+"}");break;case"lt":a=a.replace(i,"if(x++<"+t[3]+"){"+i+"}");break;case"gt":a=a.replace(i,"if(x++>"+t[3]+"){"+i+"}");break;default:r=!1}}return e.Object({source:a,status:r})}}(this)),NW.Dom.registerSelector("jquery:pseudo",/^\:(has|checkbox|file|image|password|radio|reset|submit|text|button|input|header|hidden|visible|parent)(?:\(\s*(["']*)?([^'"()]*)\2\s*\))?(.*)/i,function(e){return function(t,a){var s=!0,r=NW.Dom.ACCEPT_NODE;switch(t[1].toLowerCase()){case"has":a=a.replace(r,'if(e.getElementsByTagName("'+t[3].replace(/^\s|\s$/g,"")+'")[0]){'+r+"}");break;case"checkbox":case"file":case"image":case"password":case"radio":case"reset":case"submit":case"text":a="if(/^"+t[1]+"$/i.test(e.type)){"+a+"}";break;case"button":case"input":a="if(e.type||/button/i.test(e.nodeName)){"+a+"}";break;case"header":a="if(/h[1-6]/i.test(e.nodeName)){"+a+"}";break;case"hidden":a="if(!e.offsetWidth&&!e.offsetHeight){"+a+"}";break;case"visible":a="if(e.offsetWidth||e.offsetHeight){"+a+"}";break;case"parent":a+="if(e.firstChild){"+a+"}";break;default:s=!1}return e.Object({source:a,status:s})}}(this));