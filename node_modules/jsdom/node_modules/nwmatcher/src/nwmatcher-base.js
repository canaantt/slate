/*
 * Copyright (C) 2007-2016 Diego Perini
 * All rights reserved.
 *
 * nwmatcher-base.js - A fast CSS selector engine and matcher
 *
 * Author: Diego Perini <diego.perini at gmail com>
 * Version: 1.3.8
 * Created: 20070722
 * Release: 20160613
 *
 * License:
 *  http://javascript.nwbox.com/NWMatcher/MIT-LICENSE
 * Download:
 *  http://javascript.nwbox.com/NWMatcher/nwmatcher.js
 */
!function(e,t){"object"==typeof module&&"object"==typeof exports?(module.exports=function(e){e.console=console,e.parseInt=parseInt,e.Function=Function,e.Boolean=Boolean,e.Number=Number,e.RegExp=RegExp,e.String=String,e.Object=Object,e.Array=Array,e.Error=Error,e.Date=Date,e.Math=Math;var r=e.Object();return t(e,r),r},module.factory=t):(t(e,(e.NW||(e.NW=e.Object()))&&(e.NW.Dom||(e.NW.Dom=e.Object()))),e.NW.Dom.factory=t)}(this,function(e,t){var r,n,a,i,s,l,o,c,u,f,g,m="nwmatcher-1.3.8",p=t,d=e.document,h=d.documentElement,b=(e.Array.slice,"[#.:]?"),x="([~*^$|!]?={1})",N="[\\x20\\t\\n\\r\\f]*",v="[\\x20]|[>+~](?=[^>+~])",E="(?:[-+]?\\d*n)?[-+]?\\d*",y='"[^"\\\\]*(?:\\\\.[^"\\\\]*)*"'+"|'[^'\\\\]*(?:\\\\.[^'\\\\]*)*'",O="\\[.*\\]|\\(.*\\)|\\{.*\\}",C="(?:[-\\w]|[^\\x00-\\xa0]|\\\\.)",A="(?:-?[_a-zA-Z]{1}[-\\w]*|[^\\x00-\\xa0]+|\\\\.+)+",S="("+y+"|"+A+")",j=N+"("+C+"*:?"+C+"+)"+N+"(?:"+x+N+S+")?"+N,I=j.replace(S,"([\\x22\\x27]*)((?:\\\\?.)*?)\\3"),T="((?:"+E+"|"+y+"|"+b+"|"+C+"+|\\["+j+"\\]|\\(.+\\)|"+N+"|,)+)",w=".+",R="(?=[\\x20\\t\\n\\r\\f]*[^>+~(){}<>])(\\*|(?:"+b+A+")|"+v+"|\\["+j+"\\]|\\("+T+"\\)|\\{"+w+"\\}|(?:,|"+N+"))+",k=R.replace(T,".*"),B=e.RegExp(R),D=e.RegExp("^"+N+"|"+N+"$","g"),U=e.RegExp("([^,\\\\()[\\]]+|\\[[^[\\]]*\\]|\\[.*\\]|\\([^()]+\\)|\\(.*\\)|\\{[^{}]+\\}|\\{.*\\}|\\\\.)+","g"),L=e.RegExp("(\\["+j+"\\]|\\("+T+"\\)|\\\\.|[^\\x20\\t\\n\\r\\f>+~])+","g"),$=/[\x20\t\n\r\f]+/g,H=e.RegExp(A+"|^$"),M=e.Object({checked:1,disabled:1,ismap:1,multiple:1,readonly:1,selected:1}),z=e.Object({value:"defaultValue",checked:"defaultChecked",selected:"defaultSelected"}),G=e.Object({action:2,cite:2,codebase:2,data:2,href:2,longdesc:2,lowsrc:2,src:2,usemap:2}),F=e.Object(),V=e.Object({"=":"n=='%m'","^=":"n.indexOf('%m')==0","*=":"n.indexOf('%m')>-1","|=":"(n+'-').indexOf('%m-')==0","~=":"(' '+n+' ').indexOf(' %m ')>-1","$=":"n.substr(n.length-'%m'.length)=='%m'"}),_=e.Object({ID:e.RegExp("^\\*?#("+C+"+)|"+O),TAG:e.RegExp("^("+C+"+)|"+O),CLASS:e.RegExp("^\\*?\\.("+C+"+$)|"+O)}),W=e.Object({universal:/^\*(.*)/,id:e.RegExp("^#("+C+"+)(.*)"),tagName:e.RegExp("^("+C+"+)(.*)"),className:e.RegExp("^\\.("+C+"+)(.*)"),attribute:e.RegExp("^\\["+I+"\\](.*)"),children:/^[\x20\t\n\r\f]*\>[\x20\t\n\r\f]*(.*)/,adjacent:/^[\x20\t\n\r\f]*\+[\x20\t\n\r\f]*(.*)/,relative:/^[\x20\t\n\r\f]*\~[\x20\t\n\r\f]*(.*)/,ancestor:/^[\x20\t\n\r\f]+(.*)/}),P="getElementsByTagName"in d,Q="getElementsByClassName"in d,Y="function"!=typeof d.addEventListener,q=e.Object({"class":0,href:1,lang:1,src:1,style:1,title:1,type:1,xmlns:1,"xml:lang":1,"xml:space":1}),Z=Y?".toUpperCase()":"",J="r[r.length]=c[k];if(f&&false===f(c[k]))break main;else continue main;",K=Y?'if(e.nodeName<"A")continue;':"",X=e.Object({CACHING:!1,SIMPLENOT:!0,UNIQUE_ID:!0,USE_HTML5:!0,VERBOSITY:!0}),ee=function(t){if("string"==typeof t)return X[t]||X;if("object"!=typeof t)return!1;for(var r in t)X[r]=!!t[r],"SIMPLENOT"==r&&(xe=e.Object(),Ne=e.Object(),ve=e.Object(),Ee=e.Object());return B=e.RegExp(X.SIMPLENOT?R:k),!0},te=function(e,t,r){for(var n,a=-1;(n=t[++a])&&!1!==r(e[e.length]=n););return e},re=function(t){if(X.VERBOSITY)throw e.Error(t);e.console&&e.console.log&&e.console.log(t)},ne=function(e,t){var r=d;i=e,d=e.ownerDocument||e,(t||r!==d)&&(h=d.documentElement,g="DiV"==d.createElement("DiV").nodeName,f=g||"string"!=typeof d.compatMode?function(){var e=d.createElement("div").style;return e&&(e.width=1)&&"1px"==e.width}():d.compatMode.indexOf("CSS")<0,X.CACHING&&p.setCache(!0,d))},ae=function(e){return e.replace(/\\([0-9a-fA-F]{1,6}\x20?|.)|([\x22\x27])/g,function(e,t,r){var n,a,i,s,l;return r?"\\"+r:/^[0-9a-fA-F]/.test(t)?(n=parseInt(t,16),0>n||n>1114111?"\\ufffd":65535>=n?(s="000"+n.toString(16),"\\u"+s.substr(s.length-4)):(n-=65536,i=(n>>10)+55296,l=n%1024+56320,a="000"+i.toString(16),s="000"+l.toString(16),"\\u"+a.substr(a.length-4)+"\\u"+s.substr(s.length-4))):/^[\\\x22\x27]/.test(t)?e:t})},ie=function(e,t){for(var r=0,n=null;(n=t[r])&&n.getAttribute("id")!=e;)++r;return n},se="fileSize"in d?function(e,t){var r=null;return e=e.replace(/\\([^\\]{1})/g,"$1"),g||9!=t.nodeType?ie(e,t.getElementsByTagName("*")):(r=t.getElementById(e))&&r.name==e&&t.getElementsByName?ie(e,t.getElementsByName(e)):r}:function(e,t){return e=e.replace(/\\([^\\]{1})/g,"$1"),t.getElementById&&t.getElementById(e)||ie(e,t.getElementsByTagName("*"))},le=function(e,t){return t||(t=d),i!==t&&ne(t),se(e,t)},oe=function(t,r){var n="*"==t,a=r,i=e.Array(),s=a.firstChild;for(n||(t=t.toUpperCase());a=s;)if(a.tagName>"@"&&(n||a.tagName.toUpperCase()==t)&&(i[i.length]=a),!(s=a.firstChild||a.nextSibling))for(;!s&&(a=a.parentNode)&&a!==r;)s=a.nextSibling;return i},ce=function(e,t){return t=t.toLowerCase(),"object"==typeof e[t]?e.attributes[t]&&e.attributes[t].value:"type"==t?e.getAttribute(t):G[t]?e.getAttribute(t,2):M[t]?e.getAttribute(t)?t:"false":(e=e.getAttributeNode(t))&&e.value},ue=h.hasAttribute?function(e,t){return e.hasAttribute(t)}:function(e,t){var r=e.getAttributeNode(t=t.toLowerCase());return z[t]&&"value"!=t?e[z[t]]:r&&r.specified},fe=function(t,r,n){var a="string"==typeof t?t.match(U):t;if("string"==typeof r||(r=""),1==a.length)r+=me(a[0],n?J:"f&&f(k);return true;",n);else for(var i,s=-1,l=e.Object();i=a[++s];)i=i.replace(D,""),!l[i]&&(l[i]=!0)&&(r+=me(i,n?J:"f&&f(k);return true;",n));return n?e.Function("c,s,r,d,h,g,f,v","var N,n,x=0,k=-1,e;main:while((e=c[++k])){"+r+"}return r;"):e.Function("e,s,r,d,h,g,f,v","var N,n,x=0,k=e;"+r+"return false;")},ge="var z=v[@]||(v[@]=[]),l=z.length-1;while(l>=0&&z[l]!==e)--l;if(l!==-1){break;}z[z.length]=e;",me=function(e,t,r){for(var n,a,i,s,l,o,c=0;e;){if(c++,a=e.match(W.universal))n="";else if(a=e.match(W.id))t="if("+(g?'s.getAttribute(e,"id")':'(e.submit?s.getAttribute(e,"id"):e.id)')+'=="'+a[1]+'"){'+t+"}";else if(a=e.match(W.tagName))t="if(e.nodeName"+(g?'=="'+a[1]+'"':Z+'=="'+a[1].toUpperCase()+'"')+"){"+t+"}";else if(a=e.match(W.className))t="if((n="+(g?'e.getAttribute("class")':"e.className")+')&&n.length&&(" "+'+(f?"n.toLowerCase()":"n")+".replace("+$+'," ")+" ").indexOf(" '+(f?a[1].toLowerCase():a[1])+' ")>-1){'+t+"}";else if(a=e.match(W.attribute)){if(a[2]&&!V[a[2]])return re('Unsupported operator in attribute selectors "'+e+'"'),"";l="false",a[2]&&a[4]&&(l=V[a[2]])?(a[4]=ae(a[4]),q["class"]=f?1:0,o=q[a[1].toLowerCase()],l=l.replace(/\%m/g,o?a[4].toLowerCase():a[4])):("!="==a[2]||"="==a[2])&&(l="n"+a[2]+'=""'),t='if(n=s.hasAttribute(e,"'+a[1]+'")){'+(a[2]?'n=s.getAttribute(e,"'+a[1]+'")':"")+(o&&a[2]?".toLowerCase();":";")+"if("+(a[2]?l:"n")+"){"+t+"}}"}else if(a=e.match(W.adjacent))t=(r?"":ge.replace(/@/g,c))+t,t="var N"+c+'=e;while(e&&(e=e.previousSibling)){if(e.nodeName>"@"){'+t+"break;}}e=N"+c+";";else if(a=e.match(W.relative))t=(r?"":ge.replace(/@/g,c))+t,t="var N"+c+"=e;e=e.parentNode.firstChild;while(e&&e!==N"+c+'){if(e.nodeName>"@"){'+t+"}e=e.nextSibling;}e=N"+c+";";else if(a=e.match(W.children))t=(r?"":ge.replace(/@/g,c))+t,t="var N"+c+"=e;while(e&&e!==h&&e!==g&&(e=e.parentNode)){"+t+"break;}e=N"+c+";";else if(a=e.match(W.ancestor))t=(r?"":ge.replace(/@/g,c))+t,t="var N"+c+"=e;while(e&&e!==h&&e!==g&&(e=e.parentNode)){"+t+"}e=N"+c+";";else{n=!1,s=!1;for(n in F)if((a=e.match(F[n].Expression))&&a[1]&&(i=F[n].Callback(a,t),t=i.source,s=i.status))break;if(!s)return re('Unknown pseudo-class selector "'+e+'"'),"";if(!n)return re('Unknown token in selector "'+e+'"'),""}if(!a)return re('Invalid syntax in selector "'+e+'"'),"";e=a&&a[a.length-1]}return t},pe=function(e,t,n,a){var s;if(!e||1!=e.nodeType)return re("Invalid element argument"),!1;if("string"!=typeof t)return re("Invalid selector argument"),!1;if(i!==n&&ne(n||(n=e.ownerDocument)),t=t.replace(D,""),X.SHORTCUTS&&(t=p.shortcuts(t,e,n)),l!=t){if(!(s=t.match(B))||s[0]!=t)return re('The string "'+t+'", is not a valid CSS selector'),!1;r=(s=t.match(U)).length<2,l=t,c=s}else s=c;return Ne[t]&&xe[t]===n||(Ne[t]=fe(r?[t]:s,"",!1),xe[t]=n),Ne[t](e,ye,[],d,h,n,a,{})},de=function(e,t){return he(e,t,function(){return!1})[0]||null},he=function(t,r,l){var c,f,m,b,x,N=t;if(0===arguments.length)return re("Not enough arguments"),[];if("string"!=typeof t)return[];if(r&&!/1|9|11/.test(r.nodeType))return re("Invalid or illegal context element"),[];if(i!==r&&ne(r||(r=d)),X.CACHING&&(m=p.loadResults(N,r,d,h)))return l?te([],m,l):m;if(t=t.replace(D,""),X.SHORTCUTS&&(t=p.shortcuts(t,r)),c=o!=t){if(!(b=t.match(B))||b[0]!=t)return re('The string "'+t+'", is not a valid CSS selector'),[];n=(b=t.match(U)).length<2,o=t,u=b}else b=u;if(11==r.nodeType)m=oe("*",r);else if(n){if(c&&(b=t.match(L),x=b[b.length-1],a=x.split(":not"),a=a[a.length-1],s=t.length-x.length),X.UNIQUE_ID&&(b=a.match(_.ID))&&(x=b[1])?(f=se(x,r))&&(pe(f,t)?(l&&l(f),m=e.Array(f)):m=e.Array()):X.UNIQUE_ID&&(b=t.match(_.ID))&&(x=b[1])&&((f=se(x,d))?"#"+x==t?(l&&l(f),m=e.Array(f)):r=/[>+~]/.test(t)?f.parentNode:f:m=e.Array()),m)return X.CACHING&&p.saveResults(N,r,d,m),m;if(!g&&P&&(b=a.match(_.TAG))&&(x=b[1])){if(0===(m=r.getElementsByTagName(x)).length)return[];t=t.slice(0,s)+t.slice(s).replace(x,"*")}else if(!g&&Q&&(b=a.match(_.CLASS))&&(x=b[1])){if(0===(m=r.getElementsByClassName(x.replace(/\\([^\\]{1})/g,"$1"))).length)return[];t=t.slice(0,s)+t.slice(s).replace("."+x,H.test(t.charAt(t.indexOf(x)-1))?"":"*")}}return m||(m=Y?/^(?:applet|object)$/i.test(r.nodeName)?r.childNodes:r.all:r.getElementsByTagName("*")),Ee[t]&&ve[t]===r||(Ee[t]=fe(n?[t]:b,K,!0),ve[t]=r),m=Ee[t](m,ye,[],d,h,r,l,{}),X.CACHING&&p.saveResults(N,r,d,m),m},be=function(e){return e},xe=e.Object(),Ne=e.Object(),ve=e.Object(),Ee=e.Object(),ye=e.Object({byId:se,match:pe,select:he,getAttribute:ce,hasAttribute:ue});Tokens=e.Object({prefixes:b,encoding:C,operators:x,whitespace:N,identifier:A,attributes:j,combinators:v,pseudoclass:T,pseudoparms:E,quotedvalue:y}),p.ACCEPT_NODE=J,p.byId=le,p.match=pe,p.first=de,p.select=he,p.compile=fe,p.configure=ee,p.setCache=be,p.shortcuts=be,p.loadResults=be,p.saveResults=be,p.emit=re,p.Config=X,p.Snapshot=ye,p.Operators=V,p.Selectors=F,p.Tokens=Tokens,p.Version=m,p.registerOperator=function(e,t){V[e]||(V[e]=t)},p.registerSelector=function(t,r,n){F[t]||(F[t]=e.Object({Expression:r,Callback:n}))},ne(d,!0)});