"use strict";var util=require("util"),cssstyle=require("../lib/CSSStyleDeclaration"),camelToDashed=require("../lib/parsers").camelToDashed,properties=["azimuth","background","backgroundAttachment","backgroundColor","backgroundImage","backgroundPosition","backgroundRepeat","border","borderCollapse","borderColor","borderSpacing","borderStyle","borderTop","borderRight","borderBottom","borderLeft","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderWidth","bottom","captionSide","clear","clip","color","content","counterIncrement","counterReset","cue","cueAfter","cueBefore","cursor","direction","display","elevation","emptyCells","cssFloat","font","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","height","left","letterSpacing","lineHeight","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginTop","marginRight","marginBottom","marginLeft","markerOffset","marks","maxHeight","maxWidth","minHeight","minWidth","orphans","outline","outlineColor","outlineStyle","outlineWidth","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","page","pageBreakAfter","pageBreakBefore","pageBreakInside","pause","pauseAfter","pauseBefore","pitch","pitchRange","playDuring","position","quotes","richness","right","size","speak","speakHeader","speakNumeral","speakPunctuation","speechRate","stress","tableLayout","textAlign","textDecoration","textIndent","textShadow","textTransform","top","unicodeBidi","verticalAlign","visibility","voiceFamily","volume","whiteSpace","widows","width","wordSpacing","zIndex"],dashed_properties=properties.map(function(e){return camelToDashed(e)});module.exports={"Verify Has Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2*properties.length),properties.forEach(function(o){e.ok(t.__lookupGetter__(o),"missing "+o+" property"),e.ok(t.__lookupSetter__(o),"missing "+o+" property")}),e.done()},"Verify Has Dashed Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2*dashed_properties.length),dashed_properties.forEach(function(o){e.ok(t.__lookupGetter__(o),"missing "+o+" property"),e.ok(t.__lookupSetter__(o),"missing "+o+" property")}),e.done()},"Verify Has Functions":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(6),e.ok("function"==typeof t.getPropertyValue,"missing getPropertyValue()"),e.ok("function"==typeof t.getPropertyCSSValue,"missing getPropertyCSSValue()"),e.ok("function"==typeof t.removeProperty,"missing removeProperty()"),e.ok("function"==typeof t.getPropertyPriority,"missing getPropertyPriority()"),e.ok("function"==typeof t.setProperty,"missing setProperty()"),e.ok("function"==typeof t.item,"missing item()"),e.done()},"Verify Has Special Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(5),e.ok(t.__lookupGetter__("cssText"),"missing cssText getter"),e.ok(t.__lookupSetter__("cssText"),"missing cssText setter"),e.ok(t.__lookupGetter__("length"),"missing length getter"),e.ok(t.__lookupSetter__("length"),"missing length setter"),e.ok(t.__lookupGetter__("parentRule"),"missing parentRule getter"),e.done()},"Test From Style String":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(8),t.cssText="color: blue; background-color: red; width: 78%",e.ok(3===t.length,"length is not 3"),e.ok("color: blue; background-color: red; width: 78%;"===t.cssText,"cssText is wrong"),e.ok("blue"===t.getPropertyValue("color"),"getPropertyValue('color') failed"),e.ok("color"===t.item(0),"item(0) failed"),e.ok("background-color"===t[1],"style[1] failed"),e.ok("red"===t.backgroundColor,'style.backgroundColor failed with "'+t.backgroundColor+'"'),t.cssText="",e.ok(""===t.cssText,"cssText is not empty"),e.ok(0===t.length,"length is not 0"),e.done()},"Test From Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(11),t.color="blue",e.ok(1===t.length,"length is not 1"),e.ok("color"===t[0],"style[0] is not color"),e.ok("color: blue;"===t.cssText,"cssText is wrong"),e.ok("color"===t.item(0),"item(0) is not color"),e.ok("blue"===t.color,"color is not blue"),t.backgroundColor="red",e.ok(2===t.length,"length is not 2"),e.ok("color"===t[0],"style[0] is not color"),e.ok("background-color"===t[1],"style[1] is not background-color"),e.ok("color: blue; background-color: red;"===t.cssText,"cssText is wrong"),e.ok("red"===t.backgroundColor,"backgroundColor is not red"),t.removeProperty("color"),e.ok("background-color"===t[0],"style[0] is not background-color"),e.done()},"Test Shorthand Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(11),t.background="blue url(http://www.example.com/some_img.jpg)",e.ok("blue"===t.backgroundColor,"backgroundColor is not blue"),e.ok("url(http://www.example.com/some_img.jpg)"===t.backgroundImage,"backgroundImage is wrong"),e.ok("blue url(http://www.example.com/some_img.jpg)"===t.background,"background is different"),t.border="0 solid black",e.ok("0px"===t.borderWidth,"borderWidth is not 0px"),e.ok("solid"===t.borderStyle,"borderStyle is not solid"),e.ok("black"===t.borderColor,"borderColor is not black"),e.ok("0px"===t.borderTopWidth,"borderTopWidth is not 0px"),e.ok("solid"===t.borderLeftStyle,"borderLeftStyle is not solid"),e.ok("black"===t.borderBottomColor,"borderBottomColor is not black"),t.font="12em monospace",e.ok("12em"===t.fontSize,"fontSize is not 12em"),e.ok("monospace"===t.fontFamily,"fontFamily is not monospace"),e.done()},"Test width and height Properties and null and empty strings":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(7),t.height=6,e.ok(""===t.height,"height does not remain unset"),t.width=0,e.ok("0px"===t.width,"width is not 0px"),t.height="34%",e.ok("34%"===t.height,"height is not 34%"),t.height="",e.ok(1===t.length,"length is not 1"),e.ok("width: 0px;"===t.cssText,'cssText is not "width: 0px;"'),t.width=null,e.ok(0===t.length,"length is not 0"),e.ok(""===t.cssText,"cssText is not empty string"),e.done()},"Test Implicit Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(7),t.borderWidth=0,e.ok(1===t.length,"length is not 1"),e.ok("0px"===t.borderWidth,"borderWidth is not 0px"),e.ok("0px"===t.borderTopWidth,"borderTopWidth is not 0px"),e.ok("0px"===t.borderBottomWidth,"borderBottomWidth is not 0px"),e.ok("0px"===t.borderLeftWidth,"borderLeftWidth is not 0px"),e.ok("0px"===t.borderRightWidth,"borderRightWidth is not 0px"),e.ok("border-width: 0px;"===t.cssText,'cssText is not "border-width: 0px", "'+t.cssText+'"'),e.done()},"Test Top, Left, Right, Bottom Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(6),t.top=0,t.left="0%",t.right="5em",t.bottom="12pt",e.ok("0px"===t.top,"top is not 0px"),e.ok("0%"===t.left,"left is not 0%"),e.ok("5em"===t.right,"right is not 5em"),e.ok("12pt"===t.bottom,"bottom is not 12pt"),e.ok(4===t.length,"length is not 4"),e.ok("top: 0px; left: 0%; right: 5em; bottom: 12pt;"===t.cssText,'text is not "top: 0px; left: 0%; right: 5em; bottom: 12pt;"'),e.done()},"Test Clear and Clip Properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(10),t.clear="none",e.ok("none"===t.clear,"clear is not none"),t.clear="lfet",e.ok("none"===t.clear,"clear is not still none"),t.clear="left",e.ok("left"===t.clear,"clear is not left"),t.clear="right",e.ok("right"===t.clear,"clear is not right"),t.clear="both",e.ok("both"===t.clear,"clear is not both"),t.clip="elipse(5px, 10px)",e.ok(""===t.clip,"clip should not be set"),e.ok(1===t.length,"length is not 1"),t.clip="rect(0, 3Em, 2pt, 50%)",e.ok("rect(0px, 3em, 2pt, 50%)"===t.clip,'clip is not "rect(0px, 3em, 2pt, 50%)", "'+t.clip+'"'),e.ok(2===t.length,"length is not 2"),e.ok("clear: both; clip: rect(0px, 3em, 2pt, 50%);"===t.cssText,'cssText is not "clear: both; clip: rect(0px, 3em, 2pt, 50%);"'),e.done()},"Test colors":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(4),t.color="rgba(0,0,0,0)",e.ok("rgba(0, 0, 0, 0)"===t.color,"color is not rgba(0, 0, 0, 0)"),t.color="rgba(5%, 10%, 20%, 0.4)",e.ok("rgba(12, 25, 51, 0.4)"===t.color,"color is not rgba(12, 25, 51, 0.4)"),t.color="rgb(33%, 34%, 33%)",e.ok("rgb(84, 86, 84)"===t.color,"color is not rgb(84, 86, 84)"),t.color="rgba(300, 200, 100, 1.5)",e.ok("rgb(255, 200, 100)"===t.color,"color is not rgb(255, 200, 100) "+t.color),e.done()},"Test short hand properties with embedded spaces":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(4),t.background="rgb(0, 0, 0) url(/something/somewhere.jpg)",e.ok("rgb(0, 0, 0)"===t.backgroundColor,"backgroundColor is not rgb(0, 0, 0): "+t.backgroundColor),e.ok("url(/something/somewhere.jpg)"===t.backgroundImage,"backgroundImage is not url(/something/somewhere.jpg): "+t.backgroundImage),e.ok("background: rgb(0, 0, 0) url(/something/somewhere.jpg);"===t.cssText,"cssText is not correct: "+t.cssText),t=new cssstyle.CSSStyleDeclaration,t.border="  1px  solid   black  ",e.ok("1px solid black"===t.border,"multiple spaces not properly parsed: "+t.border),e.done()},"Setting shorthand properties to an empty string should clear all dependent properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2),t.borderWidth="1px",e.ok("border-width: 1px;"===t.cssText,'cssText is not "border-width: 1px;": '+t.cssText),t.border="",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),e.done()},"Setting implicit properties to an empty string should clear all dependent properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2),t.borderTopWidth="1px",e.ok("border-top-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px;": '+t.cssText),t.borderWidth="",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),e.done()},"Setting a shorthand property, whose shorthands are implicit properties, to an empty string should clear all dependent properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(4),t.borderTopWidth="1px",e.ok("border-top-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px;": '+t.cssText),t.border="",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),t.borderTop="1px solid black",e.ok("border-top: 1px solid black;"===t.cssText,'cssText is not "border-top: 1px solid black;": '+t.cssText),t.border="",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),e.done()},'Setting border values to "none" should clear dependent values':function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(8),t.borderTopWidth="1px",e.ok("border-top-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px;": '+t.cssText),t.border="none",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),t.borderTopWidth="1px",e.ok("border-top-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px;": '+t.cssText),t.borderTopStyle="none",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),t.borderTopWidth="1px",e.ok("border-top-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px;": '+t.cssText),t.borderTop="none",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),t.borderTopWidth="1px",t.borderLeftWidth="1px",e.ok("border-top-width: 1px; border-left-width: 1px;"===t.cssText,'cssText is not "border-top-width: 1px; border-left-width: 1px;": '+t.cssText),t.borderTop="none",e.ok("border-left-width: 1px;"===t.cssText,'cssText is not "border-left-width: 1px;": '+t.cssText),e.done()},"Setting border to 0 should be okay":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(1),t.border=0,e.ok("border: 0px;"===t.cssText,'cssText is not "border: 0px;": '+t.cssText),e.done()},"Setting values implicit and shorthand properties via cssText and setProperty should propagate to dependent properties":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(4),t.cssText="border: 1px solid black;",e.ok("border: 1px solid black;"===t.cssText,'cssText is not "border: 1px solid black;": '+t.cssText),e.ok("1px solid black"===t.borderTop,'borderTop is not "1px solid black": '+t.borderTop),t.border="",e.ok(""===t.cssText,'cssText is not "": '+t.cssText),t.setProperty("border","1px solid black"),e.ok("border: 1px solid black;"===t.cssText,'cssText is not "border: 1px solid black;": '+t.cssText),e.done()},"Setting opacity should work":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(3),t.setProperty("opacity",.75),e.ok("opacity: 0.75;"===t.cssText,'cssText is not "opacity: 0.75;": '+t.cssText),t.opacity="0.50",e.ok("opacity: 0.5;"===t.cssText,'cssText is not "opacity: 0.5;": '+t.cssText),t.opacity=1,e.ok("opacity: 1;"===t.cssText,'cssText is not "opacity: 1;": '+t.cssText),e.done()},"Width and height of auto should work":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(4),t.width="auto",e.equal(t.cssText,"width: auto;",'cssText is not "width: auto;": '+t.cssText),e.equal(t.width,"auto",'width is not "auto": '+t.width),t=new cssstyle.CSSStyleDeclaration,t.height="auto",e.equal(t.cssText,"height: auto;",'cssText is not "height: auto;": '+t.cssText),e.equal(t.height,"auto",'height is not "auto": '+t.height),e.done()},"Padding and margin should set/clear shorthand properties":function(e){var t=new cssstyle.CSSStyleDeclaration,o=["Top","Right","Bottom","Left"],r=function(r,s,n){t[r]=s;for(var i=0;4>i;i++){var c=r+o[i];e.equal(n[i],t[c],c+' is not "'+n[i]+'": "'+t[c]+'"')}e.equal(s,t[r],r+' is not "'+s+'": "'+t[r]+'"'),t[r]=""};e.expect(50),r("padding","1px",["1px","1px","1px","1px"]),r("padding","1px 2%",["1px","2%","1px","2%"]),r("padding","1px 2px 3px",["1px","2px","3px","2px"]),r("padding","1px 2px 3px 4px",["1px","2px","3px","4px"]),t.paddingTop=t.paddingRight=t.paddingBottom=t.paddingLeft="1px",r("padding","",["","","",""]),r("margin","1px",["1px","1px","1px","1px"]),r("margin","1px auto",["1px","auto","1px","auto"]),r("margin","1px 2% 3px",["1px","2%","3px","2%"]),r("margin","1px 2px 3px 4px",["1px","2px","3px","4px"]),t.marginTop=t.marginRight=t.marginBottom=t.marginLeft="1px",r("margin","",["","","",""]),e.done()},"Padding and margin shorthands should set main properties":function(e){var t=new cssstyle.CSSStyleDeclaration,o=["Top","Right","Bottom","Left"],r=function(r,s,n){for(var i,c=0;4>c;c++)t[r]=s,t[r+o[c]]=n,i=s.split(/ /),i[c]=n,i=i.join(" "),e.equal(i,t[r],r+' is not "'+i+'": "'+t[r]+'"')};e.expect(12),r("padding","1px 2px 3px 4px","10px"),r("margin","1px 2px 3px 4px","10px"),r("margin","1px 2px 3px 4px","auto"),e.done()},"Setting a value to 0 should return the string value":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(1),t.setProperty("fill-opacity",0),e.ok("0"===t.fillOpacity,'fillOpacity is not "0": '+t.fillOpacity),e.done()},"onChange callback should be called when the cssText changes":function(e){var t=new cssstyle.CSSStyleDeclaration(function(t){e.ok("opacity: 0;"===t,'cssText is not "opacity: 0;": '+t),e.done()});e.expect(1),t.setProperty("opacity",0)},"Setting float should work the same as cssFloat":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(1),t["float"]="left",e.ok("left"===t.cssFloat,'cssFloat is not "left": '+t.cssFloat),e.done()},"Setting improper css to cssText should not throw":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2),t.cssText="color: ",e.ok(""===t.cssText,"cssText wasn't cleared: "+t.cssText),t.color="black",t.cssText="float: ",e.ok(""===t.cssText,"cssText wasn't cleared: "+t.cssText),e.done()},"Make sure url parsing works with quotes":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(3),t.backgroundImage="url(http://some/url/here1.png)",e.ok("url(http://some/url/here1.png)"===t.backgroundImage,"background-image wasn't url(http://some/url/here1.png): "+t.backgroundImage),t.backgroundImage="url('http://some/url/here2.png')",e.ok("url(http://some/url/here2.png)"===t.backgroundImage,"background-image wasn't url(http://some/url/here2.png): "+t.backgroundImage),t.backgroundImage='url("http://some/url/here3.png")',e.ok("url(http://some/url/here3.png)"===t.backgroundImage,"background-image wasn't url(http://some/url/here3.png): "+t.backgroundImage),e.done()},"Make sure setting 0 to a padding or margin works":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2),t.padding=0,e.equal(t.cssText,"padding: 0px;","padding is not 0px"),t.margin="1em",t.marginTop="0",e.equal(t.marginTop,"0px","margin-top is not 0px"),e.done()},"Make sure setting null to background works":function(e){var t=new cssstyle.CSSStyleDeclaration;e.expect(2),t.background="red",e.equal(t.cssText,"background: red;","background is not red"),t.background=null,e.equal(t.cssText,"","cssText is not empty"),e.done()}};