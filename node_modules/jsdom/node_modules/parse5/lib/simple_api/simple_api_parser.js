"use strict";function skip(){}var Tokenizer=require("../tokenization/tokenizer"),TokenizerProxy=require("./tokenizer_proxy"),Utils=require("../common/utils"),DEFAULT_OPTIONS={decodeHtmlEntities:!0,locationInfo:!1},SimpleApiParser=module.exports=function(e,t){this.options=Utils.mergeOptions(DEFAULT_OPTIONS,t),this.handlers={doctype:this._wrapHandler(e.doctype),startTag:this._wrapHandler(e.startTag),endTag:this._wrapHandler(e.endTag),text:this._wrapHandler(e.text),comment:this._wrapHandler(e.comment)}};SimpleApiParser.prototype._wrapHandler=function(e){var t=this;return e=e||skip,this.options.locationInfo?function(){var n=Array.prototype.slice.call(arguments);n.push(t.currentTokenLocation),e.apply(e,n)}:e},SimpleApiParser.prototype.parse=function(e){var t=null;this._reset(e);do t=this.tokenizerProxy.getNextToken(),t.type===Tokenizer.CHARACTER_TOKEN||t.type===Tokenizer.WHITESPACE_CHARACTER_TOKEN||t.type===Tokenizer.NULL_CHARACTER_TOKEN?(this.options.locationInfo&&(null===this.pendingText?this.currentTokenLocation=t.location:this.currentTokenLocation.end=t.location.end),this.pendingText=(this.pendingText||"")+t.chars):(this._emitPendingText(),this._handleToken(t));while(t.type!==Tokenizer.EOF_TOKEN)},SimpleApiParser.prototype._handleToken=function(e){this.options.locationInfo&&(this.currentTokenLocation=e.location),e.type===Tokenizer.START_TAG_TOKEN?this.handlers.startTag(e.tagName,e.attrs,e.selfClosing):e.type===Tokenizer.END_TAG_TOKEN?this.handlers.endTag(e.tagName):e.type===Tokenizer.COMMENT_TOKEN?this.handlers.comment(e.data):e.type===Tokenizer.DOCTYPE_TOKEN&&this.handlers.doctype(e.name,e.publicId,e.systemId)},SimpleApiParser.prototype._reset=function(e){this.tokenizerProxy=new TokenizerProxy(e,this.options),this.pendingText=null,this.currentTokenLocation=null},SimpleApiParser.prototype._emitPendingText=function(){null!==this.pendingText&&(this.handlers.text(this.pendingText),this.pendingText=null)};