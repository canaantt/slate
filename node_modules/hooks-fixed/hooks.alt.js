module.exports={hook:function(t,n,r){function s(){}{if(1!==arguments.length||"object"!=typeof t){r||(r=n);var e=this.prototype||this,o=e._pres=e._pres||{},a=e._posts=e._posts||{};return o[t]=o[t]||[],a[t]=a[t]||[],e[t]=function(){function e(){arguments[0]instanceof Error&&r(arguments[0])}function o(){if(arguments[0]instanceof Error)return r(arguments[0]);arguments.length&&(l=[].slice.call(arguments)),n.apply(u,l);var t=c.map(function(n,e){var o=function(){return arguments[0]instanceof Error?r(arguments[0]):(arguments.length&&(l=[].slice.call(arguments)),void n.apply(u,[t[e+1]||s].concat(l)))};return o});t.length&&t[0]()}function a(){return arguments[0]instanceof Error?r(arguments[0]):void(--complete||o.call(this))}var u=this,i=this._pres[t],c=this._posts[t],p=0,l=[].slice.call(arguments),g=i.map(function(t,n){var s=function(){return arguments[0]instanceof Error?r(arguments[0]):void(p?(arguments.length&&(l=[].slice.call(arguments,2)),t.apply(u,[g[n+1]||e,a].concat(l))):(arguments.length&&(l=[].slice.call(arguments)),t.apply(u,[g[n+1]||o].concat(l))))};return(s.isAsync=t.isAsync)&&p++,s});p&&(complete=p),(g[0]||o)()},this}for(var u in t)this.hook(u,t[u])}},pre:function(t,n,r){var s=this.prototype,e=s._pres=s._pres||{};return(n.isAsync=r)&&this.prototype[t].numAsyncPres++,(e[t]=e[t]||[]).push(n),this},post:function(t,n,r){var s=this.prototype,e=s._posts=s._posts||{};return(e[t]=e[t]||[]).push(n),this}};