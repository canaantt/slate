"use strict";module.exports=function(r,n,t,e){function i(i,a){var c=t(i);if(c instanceof r)return u(c);if(!o(i))return e("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var f=new r(n);void 0!==a&&f._propagateFrom(a,5);for(var l=f._fulfill,s=f._reject,v=0,p=i.length;p>v;++v){var h=i[v];(void 0!==h||v in i)&&r.cast(h)._then(l,s,void 0,f,null)}return f}var o=require("./util.js").isArray,u=function(r){return r.then(function(n){return i(n,r)})};r.race=function(r){return i(r,void 0)},r.prototype.race=function(){return i(this,void 0)}};