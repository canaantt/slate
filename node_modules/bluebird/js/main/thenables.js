"use strict";module.exports=function(e,r){function t(t,a){if(i(t)){if(t instanceof e)return t;if(c(t)){var f=new e(r);return t._then(f._fulfillUnchecked,f._rejectUncheckedCheckError,f._progressUnchecked,f,null),f}var s=o.tryCatch(n)(t);if(s===l){a&&a._pushContext();var f=e.reject(s.e);return a&&a._popContext(),f}if("function"==typeof s)return u(t,s,a)}return t}function n(e){return e.then}function c(e){return a.call(e,"_promise0")}function u(t,n,c){function u(e){f&&(f._resolveCallback(e),f=null)}function i(e){f&&(f._rejectCallback(e,p,!0),f=null)}function a(e){f&&"function"==typeof f._progress&&f._progress(e)}var f=new e(r),s=f;c&&c._pushContext(),f._captureStackTrace(),c&&c._popContext();var p=!0,_=o.tryCatch(n).call(t,u,i,a);return p=!1,f&&_===l&&(f._rejectCallback(_.e,!0,!0),f=null),s}var o=require("./util.js"),l=o.errorObj,i=o.isObject,a={}.hasOwnProperty;return t};