"use strict";module.exports=function(e,t,r,n){var a,l=require("./util.js"),i=l.canEvaluate,o=l.tryCatch,s=l.errorObj;if(i){for(var u=function(e){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,e))},c=function(e){for(var t=[],r=1;e>=r;++r)t.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,t.join(", ")))},h=[],p=[void 0],v=1;5>=v;++v)h.push(u(v)),p.push(c(v));var f=function(e,t){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=t,this.total=e,this.now=0};f.prototype.callers=p,f.prototype.checkFulfillment=function(e){var t=this.now;t++;var r=this.total;if(t>=r){var n=this.callers[r];e._pushContext();var a=o(n)(this);e._popContext(),a===s?e._rejectCallback(a.e,!1,!0):e._resolveCallback(a)}else this.now=t};var a=function(e){this._reject(e)}}e.join=function(){var l,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(l=arguments[o],6>o&&i)){var s=new e(n);s._captureStackTrace();for(var u=new f(o,l),c=h,p=0;o>p;++p){var v=r(arguments[p],s);v instanceof e?(v=v._target(),v._isPending()?v._then(c[p],a,void 0,s,u):v._isFulfilled()?c[p].call(s,v._value(),u):s._reject(v._reason())):c[p].call(s,v,u)}return s}for(var d=arguments.length,_=new Array(d),g=0;d>g;++g)_[g]=arguments[g];l&&_.pop();var s=new t(_).promise();return void 0!==l?s.spread(l):s}};