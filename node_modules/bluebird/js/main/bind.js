"use strict";module.exports=function(e,t,i){var n=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(n,n,null,this,e)},r=function(e,t){this._isPending()&&this._resolveCallback(t.target)},s=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(n){var u=i(n),_=new e(t);_._propagateFrom(this,1);var c=this._target();if(_._setBoundTo(u),u instanceof e){var l={promiseRejectionQueued:!1,promise:_,target:c,bindingPromise:u};c._then(t,o,_._progress,_,l),u._then(r,s,_._progress,_,l)}else _._resolveCallback(c);return _},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=131072|this._bitField,this._boundTo=e):this._bitField=-131073&this._bitField},e.prototype._isBound=function(){return 131072===(131072&this._bitField)},e.bind=function(n,o){var r=i(n),s=new e(t);return s._setBoundTo(r),r instanceof e?r._then(function(){s._resolveCallback(o)},s._reject,s._progress,s,null):s._resolveCallback(o),s}};