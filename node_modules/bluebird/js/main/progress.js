"use strict";module.exports=function(e,r){var t=require("./util.js"),o=require("./async.js"),s=t.tryCatch,i=t.errorObj;e.prototype.progressed=function(e){return this._then(void 0,void 0,e,void 0,void 0)},e.prototype._progress=function(e){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(e)},e.prototype._progressHandlerAt=function(e){return 0===e?this._progressHandler0:this[(e<<2)+e-5+2]},e.prototype._doProgressWith=function(r){var o=r.value,n=r.handler,a=r.promise,c=r.receiver,p=s(n).call(c,o);if(p===i){if(null!=p.e&&"StopProgressPropagation"!==p.e.name){var l=t.canAttachTrace(p.e)?p.e:new Error(t.toString(p.e));a._attachExtraTrace(l),a._progress(p.e)}}else p instanceof e?p._then(a._progress,null,null,a,void 0):a._progress(p)},e.prototype._progressUnchecked=function(t){for(var s=this._length(),i=this._progress,n=0;s>n;n++){var a=this._progressHandlerAt(n),c=this._promiseAt(n);if(c instanceof e)"function"==typeof a?o.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(n),value:t}):o.invoke(i,c,t);else{var p=this._receiverAt(n);"function"==typeof a?a.call(p,t,c):p instanceof r&&!p._isResolved()&&p._promiseProgressed(t,c)}}}};